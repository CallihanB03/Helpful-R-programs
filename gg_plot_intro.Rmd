---
title: "HW 3"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE,  
                      warning = FALSE, message = FALSE, 
                      fig.align = "center",
                      R.options = list(max.print=100))

# Edit the file starting below
```

### Enter your name and EID here: Callihan Bertley cjb5564

**You will submit this homework assignment as a HTML file on Canvas.**

*For all questions, include the R commands/functions that you used to find your answer (show R chunk). Answers without supporting code will not receive credit. Write full sentences to describe your findings.*

------------------------------------------------------------------------

### Question 1: (2 pts)

The dataset `ChickWeight` contains information about the weights (in grams) of chicks on four different diets over time (measured at 2-day intervals) as the result of an experiment. The first few observations are listed below.

```{r}
# Save dataset as a dataframe
ChickWeight <- as.data.frame(ChickWeight)

# Visualize the first ten rows of the dataset
head(ChickWeight,10)
```

Use some combination of `table()` and `length()` to answer the following questions: 

```{r}
table(ChickWeight)
distinct_chicks <- length(table(ChickWeight))
print(distinct_chicks)
distinct_time_points <- length(table(ChickWeight$Time))
print(distinct_time_points)
distinct_diet_conditions <- length(table(ChickWeight['Diet']))
print(distinct_diet_conditions)
chicks_per_diet <- distinct_chicks / distinct_diet_conditions
print(chicks_per_diet)
```

- How many distinct chicks are there?  
- How many distinct time points?  
- How many distinct diet conditions?  
- How many chicks per diet condition at the beginning of the experiment?  

**The ChickWeight dataframe has 508,800 distinct chicks, whose weights were recorded over 12 distinct time periods, and who were split into 4 groups who underwent 4 distinct diets. There were 127,200 chicks per diet condition at the beginning of the experiment.**
------------------------------------------------------------------------

### Question 2: (1 pt)

Using the `ggplot2` package, create a simple scatterplot showing chick `weight` (on the y-axis) depending on `Time`. Label the axes including the units of the variables and give the plot a title. How does chick `weight` change over `Time`?

```{r}
# Load package
library(ggplot2)

ggplot(data = ChickWeight, aes(x = Time, y = weight)) + geom_point() + ylab('Weight (in grams)') + xlab('Time (in days)') + ggtitle('Chick Weight over Time') + theme(plot.title = element_text(hjust = 0.5))

```

**Over time, the range of chick weights and the average chick weight increases. **
------------------------------------------------------------------------

### Question 3: (2 pts)

Building upon the previous plot, map `Chick` to an aesthetic that assigns a color to each chick’s data points. Add lines that connect each chick’s points together with `geom_line()` (also colored by each chick). Finally, remove the legend. Do all chicks seem to gain weight in the same manner? Why/Why not?

```{r}
ggplot(data = ChickWeight, aes(x = Time, y = weight)) + geom_point(aes(color=Chick)) + geom_line(aes(group=Chick, color=Chick)) + ylab('Weight (in grams)') + xlab('Time (in days)') + ggtitle('Chick Weight over Time') + theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')
```

**The chicks do not appear to gain weight at the same rate; it seems some diets result in the chicks gaining more weight than other diets.**
------------------------------------------------------------------------

### Question 4: (1 pt)

Continue modifying the same graph by removing the color from the points only: leave the lines colored by chick, but make all of the points white. Make sure to put the points *on top of* the lines. On which day was the last value of the chicks' weight recorded?

```{r}
ggplot(data = ChickWeight, aes(x = Time, y = weight)) + geom_line(aes(group=Chick, color=Chick)) + geom_point(color='White') + ylab('Weight (in grams)') + xlab('Time (in days)') + ggtitle('Chick Weight over Time') + theme(plot.title = element_text(hjust = 0.5), legend.position = 'none')

last_day <- ChickWeight$Time[length(ChickWeight$Time)]
print(last_day)
```

**The last day that the chicks' weight was recorded was on day 21.**
------------------------------------------------------------------------

### Question 5: (2 pts)

Now, facet this plot by diet. Can you tell from this new plot which diet results in greater weight? Describe how  the relationship between `weight` and `Time` changes, or not, across the different diets.

```{r}
ggplot(data = ChickWeight, aes(x = Time, y = weight)) + geom_line(aes(group=Chick, color=Chick)) + ylab('Weight (in grams)') + xlab('Time (in days)') + ggtitle('Chick Weight over Time') + theme(plot.title = element_text(hjust = 0.5), legend.position = 'none') + geom_point(color='White') + facet_wrap(~Diet)
```

**After I faucet this plot, I can tell that diet 3 results in the most massive chicks while diet 1 results in the least massive chicks. Across the different diets, weight and time are directly proportional however some diets see a greater weight gain than others.**
------------------------------------------------------------------------

### Question 6: (2 pts)

Go back to your plot from question 2 and fit a *linear regression line* (using `method = "lm"` in `geom_smooth()`) to the chicks in each diet with `geom_smooth()`. There should be 4 separate regression lines, one for each diet, each a separate color. Can you see more clearly which diet results in greater weight? Explain.

```{r}
ggplot(data = ChickWeight, aes(x = Time, y = weight)) + geom_point() + geom_smooth(method='lm', aes(color=Diet)) + ylab('Weight (in grams)') + xlab('Time (in days)') + ggtitle('Chick Weight over Time') + theme(plot.title = element_text(hjust = 0.5))
```

**From the linear regression model, I can see that diet 1 results in the least massive chicks while diet 3 results in the most massive chicks. It's easier to see the results in this plot than in the scatterplot where each point was connected by lines.**
------------------------------------------------------------------------

### Question 7: (2 pts)

A scatterplot might not be the best way to visualize this data: it calls attention to the relationship between weight and time, but it can be hard to see the differences between diets. A more traditional approach for exploring the effect of diet would be to construct a bar graph representing group means at the end of the experiment.

Index the data in the `ggplot` function to focus on the last `Time` point. *Hint: Refer to Question 4 or find the max `Time`).* Then create a plot using `geom_bar` where each bar's height corresponds to the average chick weight for each of the four diet conditions. Rename the y-axis to include units (e.g., with scale_y_continuous(`name=`...)) and make the major tick marks go from 0 to 300 by 25 (e.g., with scale_y_continuous(`breaks=`...)). Which diet has the highest mean `weight`? 

```{r}
last_day <- ChickWeight$Time[length(ChickWeight$Time)]
ggplot(ChickWeight[ChickWeight$Time == last_day,], aes(x = Diet)) +
geom_bar(aes(y=weight), stat="summary", fun=mean) + scale_y_continuous(name = 'grams', breaks=seq(0, 300, 25))
```

**Diet 3 has the largest mean weight.**
------------------------------------------------------------------------

### Question 8: (2 pts)

Building on the previous graph, add error bars showing + or - 1 SE using `geom_errorbar(stat = "summary")`. Make the error-bars skinnier by adding a `width = 0.5` argument. Color the bars (not the error bars, but the bar graph bars) by diet and change from the default color scheme using a `scale_fill_` or a `scale_color_`. Compare the different diets in terms of variation in `weight`.

```{r}
ggplot(ChickWeight[ChickWeight$Time == 21,]) + geom_bar(stat="summary", fun=mean, aes(x=Diet, y=weight, fill=Diet)) + scale_fill_manual(values=c('red', 'blue', 'green', 'yellow'))+ geom_errorbar(stat="summary", fun.data=mean_se, width=0.5, aes(x=Diet, y=weight)) + scale_y_continuous(name = 'grams', breaks=seq(0, 300, 25))
```

**Diets 2 and 3, the diets with the higher mean weights, have more variation in their weight while diets 1 and 4, the diets with the lower mean weights, have less variation in their weight.**
------------------------------------------------------------------------

### Question 9: (2 pts)

Take your code from question 8 and replace `geom_bar()` with `geom_point()`. Remove the `breaks =` argument from `scale_y_continuous`. Make the points larger and color them all red. Put them *on top of* the error bars. Does the mean chick weight seem to differ based on the diet? *Note: Informally state if they seem to differ and if so, how.*

```{r}
ggplot(ChickWeight[ChickWeight$Time == 21,], aes(x=Diet, y=weight, color=Diet)) + scale_color_manual(values=c("red", "yellow", "green", "blue")) + geom_errorbar(stat="summary", fun.data=mean_se, width=0.5) + scale_y_continuous(name = 'grams') + geom_point(stat="summary", fun.y=mean, color="red", size=10)
```

**The mean chick weight does seem to be quite different based on the diets with diets 3 and 4 having a higher mean diet weight and diets 1 and 2 having a lower mean chick weight. **
------------------------------------------------------------------------

### Question 10: (2 pts)

One last graph! And a little less guided... It would be even more meaningful to compare the mean `weight` of each `Diet` over `Time`! Use `geom_point` to represent the mean weight over time and `geom_line` to connect the mean weights per diet. Change the shape of the points to be `x` symbols. *Giving you a hint anyway: color by diet and use some `stat` options in the geoms!* Which diet has a constantly lower mean weight over time?

```{r}
# your code goes below (make sure to edit comment)
ggplot(ChickWeight) + geom_line(aes(x=Time, y=weight, color=Diet), stat = "summary", fun=mean) + geom_point(aes(x=Time, y=weight, color=Diet), stat='summary', fun=mean, shape=4) + ylab('Mean Weight (in grams)') + xlab('Time (in days)') + ggtitle('Chick Weight over Time') + theme(plot.title = element_text(hjust = 0.5))
```

**It appears that diet 1 has a constantly lower mean body weight over time compared to the other chicks.**
------------------------------------------------------------------------

### Formatting: (2 pts)

Comment your code, write full sentences, and knit your file!

------------------------------------------------------------------------

```{r, echo=F}
## DO NOT DELETE THIS BLOCK!
Sys.info()
```